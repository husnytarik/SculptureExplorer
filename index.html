<!DOCTYPE html>
<html lang="tr">

<head>
    <link rel="icon" href="data:,">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Sculpture Explorer — MVP</title>

    <!-- Styles -->
    <link rel="stylesheet" href="./css/styles.css" />

    <!-- three.js import map -->
    <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.160.1/build/three.module.js",
      "three/examples/jsm/": "https://cdn.jsdelivr.net/npm/three@0.160.1/examples/jsm/"
    }
  }
  </script>
</head>

<body>
    <noscript>Bu uygulama için JavaScript gerekli.</noscript>

    <div class="app">
        <!-- ===== VIEWER ===== -->
        <div class="viewer" id="viewer">
            <div class="overlay">
                <span id="hudInfo" class="hudline"></span>
            </div>

            <!-- Sağ dikey araç çubuğu -->
            <div class="toolrail" id="measureRail">
                <button class="toolbtn" data-mode="distance" aria-label="Mesafe">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                            <circle cx="6" cy="18" r="2" fill="currentColor" />
                            <circle cx="18" cy="6" r="2" fill="currentColor" />
                            <line x1="8.5" y1="15.5" x2="15.5" y2="8.5" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Mesafe</span>
                </button>

                <button class="toolbtn" data-mode="polyline" aria-label="Yol Uzunluğu">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                            <polyline points="4,16 10,10 16,14 20,8" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                            <circle cx="4" cy="16" r="2" fill="currentColor" />
                            <circle cx="10" cy="10" r="2" fill="currentColor" />
                            <circle cx="16" cy="14" r="2" fill="currentColor" />
                            <circle cx="20" cy="8" r="2" fill="currentColor" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Yol Uzunluğu</span>
                </button>

                <button class="toolbtn" data-mode="surface2" aria-label="Yüzey Mesafesi">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                            <circle cx="5" cy="17" r="2" fill="currentColor" />
                            <circle cx="19" cy="7" r="2" fill="currentColor" />
                            <path d="M7 15 C 10 6, 14 20, 17 9" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Yüzey Mesafesi</span>
                </button>

                <button class="toolbtn" data-mode="surfacePath" aria-label="Yüzey Yol">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M4 16 C 8 8, 12 18, 16 10 S 20 7, 20 8" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" fill="none" />
                            <circle cx="4" cy="16" r="2" fill="currentColor" />
                            <circle cx="10" cy="13" r="1.8" fill="currentColor" />
                            <circle cx="15" cy="11" r="1.8" fill="currentColor" />
                            <circle cx="20" cy="8" r="2" fill="currentColor" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Yüzey Yol</span>
                </button>

                <button class="toolbtn" data-mode="girth" aria-label="Kesit Çevresi">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="7" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-dasharray="3 2" fill="none" />
                            <circle cx="12" cy="12" r="2" fill="currentColor" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Kesit Çevresi</span>
                </button>
            </div>

            <!-- Sağ üst aksiyonlar -->
            <div class="viewer-actions">
                <!-- Işık & Görünüm toggle (ghost toolbtn) -->
                <button class="toolbtn" id="btnViewPanel" aria-label="Işık & Görünüm">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2" />
                            <line x1="12" y1="2" x2="12" y2="5" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="12" y1="19" x2="12" y2="22" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="2" y1="12" x2="5" y2="12" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="19" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="4.2" y1="4.2" x2="6.3" y2="6.3" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="17.7" y1="17.7" x2="19.8" y2="19.8" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="4.2" y1="19.8" x2="6.3" y2="17.7" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                            <line x1="17.7" y1="6.3" x2="19.8" y2="4.2" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Işık & Görünüm</span>
                </button>
            </div>

            <div class="view-panel" id="viewPanel" hidden>
                <div class="row gap8">
                    <button class="chip" id="btnPerspective" title="Perspective">Perspective</button>
                    <button class="chip" id="btnOrtho" title="Orthographic">Orthographic</button>
                    <label class="mini">FOV
                        <input id="fovSlider" type="range" min="20" max="120" value="45">
                    </label>
                </div>

                <div class="row gap8">
                    <label class="mini">Azimut
                        <input id="azimuth" type="range" min="0" max="360" value="45">
                    </label>
                    <label class="mini">Yükseklik
                        <input id="elevation" type="range" min="0" max="89" value="35">
                    </label>
                </div>

                <div class="row gap8">
                    <label class="mini">Parlaklık
                        <input id="intensity" type="range" min="0" max="1000" value="120">
                    </label>
                    <label class="mini">Arka Plan
                        <input id="bgColor" type="color" value="#a0b3cf">
                    </label>
                </div>

                <div class="row gap8 wrap">
                    <label class="check mini">
                        <input id="gridToggle" type="checkbox" checked><span>Grid</span>
                    </label>
                    <label class="check mini">
                        <input id="dirOff" type="checkbox"><span>Directional kapalı</span>
                    </label>
                    <label class="check mini">
                        <input id="grayscale" type="checkbox"><span>S/B</span>
                    </label>
                </div>
            </div>

            <!-- Viewer içi filtre kısayolları (sağ alt) -->
            <div class="viewer-filters" id="viewerFilters">
                <div class="vf-group">
                    <!-- Curvature -->
                    <button class="toolbtn" id="btnCurv" aria-label="Curvature" aria-pressed="false">
                        <span class="toolbtn__icon" aria-hidden="true">
                            <!-- curve icon -->
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M4 18 C 9 6, 15 20, 20 6" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" fill="none" />
                            </svg>
                        </span>
                        <span class="toolbtn__label">Curvature</span>
                    </button>

                    <!-- Curvature popover (üstte) -->
                    <div class="filter-popover" id="curvPopover" hidden>
                        <label class="mini">Güç
                            <input id="curvAmt" type="range" min="0.01" max="200" value="80" />
                        </label>
                    </div>
                </div>

                <!-- Edges / Sobel -->
                <button class="toolbtn" id="btnEdges" aria-label="Kenar Vurgusu" aria-pressed="false">
                    <span class="toolbtn__icon" aria-hidden="true">
                        <!-- edges icon -->
                        <svg viewBox="0 0 24 24" fill="none">
                            <rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2" />
                            <path d="M8 8 L16 16 M16 8 L8 16" stroke="currentColor" stroke-width="2" />
                        </svg>
                    </span>
                    <span class="toolbtn__label">Kenar Vurgusu</span>
                </button>
            </div>

            <!-- Ölçüm değerleri: viewer üzerinde -->
            <div class="measure-readout measure-readout--overlay" id="measureReadoutOverlay">
                <span class="muted">Ölçüm</span>
            </div>
        </div>

        <!-- ===== SIDEBAR ===== -->
        <div class="sidebar">
            <div class="sidepanel">
                <div class="sidepanel__body">
                    <!-- Model 
                    <div class="card">
                        <h3>Model</h3>
                        <div class="col">
                            <input class="input" id="modelUrl" placeholder=".glb / .gltf URL" value="./models/sc.glb" />
                            <div class="grid">
                                <button class="btn" id="loadBtn">Yükle</button>
                                <button class="btn" id="screenshotBtn">Görüntüyü Kaydet</button>
                            </div>
                        </div>
                    </div>-->
                    <!-- Katalog -->
                    <div class="card">
                        <h3>Koleksiyon</h3>
                        <div class="col">
                            <button class="btn" id="loadCatalog">Yükle</button>

                            <select id="catalogSelect" class="select placeholder-centered">
                                <option value="" disabled selected>Koleksiyon Yükleyin</option>
                            </select>
                            <button class="btn" id="applyMeta">Modeli Görüntüle</button>
                        </div>
                    </div>

                    <!-- ÖLÇÜM ARAÇLARI KARTI KALDIRILDI -->
                    <!-- ▼ Ama main.js 'must' ile bazı id'leri bekliyor.
                    Bu nedenle görünmeyen (hidden) minimal DOM'u tutuyoruz. -->
                    <div class="hide" aria-hidden="true">
                        <select id="measureMode">
                            <option value="none">—</option>
                            <option value="distance">distance</option>
                            <option value="polyline">polyline</option>
                            <option value="surface2">surface2</option>
                            <option value="surfacePath">surfacePath</option>
                            <option value="girth">girth</option>
                        </select>
                        <button id="clearMarks" type="button">clear</button>
                        <button id="exportCSV" type="button">csv</button>
                    </div>

                    <!-- Meta -->
                    <div class="card">
                        <h3>Bilgi</h3>
                        <div class="col">
                            <label class="mini" for="title">Eser adı</label>
                            <input class="input" id="title" placeholder="Eser adı" readonly />

                            <div class="grid">
                                <div class="col">
                                    <label class="mini" for="category">Kategori</label>
                                    <input class="input" id="category" placeholder="Örn: Heykel" readonly />
                                </div>
                                <div class="col">
                                    <label class="mini" for="type">Tür</label>
                                    <input class="input" id="type" placeholder="Örn: büst, figür" readonly />
                                </div>
                            </div>

                            <div class="grid">
                                <div class="col">
                                    <label class="mini" for="period">Dönem</label>
                                    <input class="input" id="period" placeholder="Örn: Roma" readonly />
                                </div>
                                <div class="col">
                                    <label class="mini" for="culture">Kültür </label>
                                    <input class="input" id="culture" placeholder="Örn: Etrüsk" readonly />
                                </div>
                            </div>

                            <div class="grid">
                                <div class="col">

                                    <label class="mini" for="title">Şu Anki Konumu</label>
                                    <input class="input" id="title" placeholder="Örn: British Museum" readonly />
                                </div>
                                <div class="col">
                                    <label class="mini" for="geo">Bulunduğu Konum</label>
                                    <input class="input" id="geo" placeholder="Örn: Xhantos Antik Kenti" readonly />
                                </div>
                            </div>
                            <label class="mini" for="material">Malzeme</label>
                            <input class="input" id="material" placeholder="Örn: Mermer" readonly />

                            <label class="mini" for="abstract">Bilimsel özet / açıklama</label>
                            <textarea class="input" id="abstract" rows="3" placeholder="Kısa açıklama"
                                readonly></textarea>

                            <label class="mini" for="publications">Yayınlar</label>
                            <textarea class="input" id="publications" rows="2" placeholder="Her satıra bir DOI/URL"
                                readonly></textarea>

                            <div class="grid">
                                <button class="btn" id="editMeta" data-editing="false">Düzenle</button>
                                <button class="btn" id="saveMeta" disabled>Kaydet</button>
                            </div>
                        </div>
                    </div>


                    <!-- Arama -->
                    <div class="card">
                        <h3>Arama / Benzer Bul</h3>
                        <div class="col">
                            <input class="input" id="q" placeholder="Ara: kategori, dönem, malzeme, kültür, konum…" />
                            <div class="grid">
                                <button class="btn" id="btnSearch">Ara</button>
                                <button class="btn" id="btnSimilar">Benzer Eserler</button>
                            </div>
                            <div class="list" id="results"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- /.sidebar -->
    </div><!-- /.app -->

    <!-- Mobil için panel aç/kapat -->
    <button class="fab" id="toggleSidebar" aria-label="Panel">☰</button>

    <!-- View panel toggle wiring -->
    <script>
        (function () {
            const fab = document.getElementById('viewFab');
            const panel = document.getElementById('viewPanel');
            const btn = document.getElementById('toggleViewPanel');

            function togglePanel() { if (panel) panel.hidden = !panel.hidden; }

            if (fab && panel) fab.addEventListener('click', togglePanel);
            if (btn && panel) btn.addEventListener('click', togglePanel);
        })();
    </script>

    <!-- Entry modules -->
    <script type="module" src="./js/main.js"></script>
</body>

</html>